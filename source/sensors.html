
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sensors &#8212; mjlab Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/css/all.min.css?v=53359634" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
    <script src="../_static/twemoji.js"></script>
    <script src="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/js/all.min.js?v=ec35c6c9"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/sensors';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RayCast Sensor" href="raycast_sensor.html" />
    <link rel="prev" title="Actuators" href="actuators.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jan 28, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">The mjlab Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mujocolab/mjlab" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mujocolab/mjlab" title="mjlab" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://img.shields.io/badge/mjlab-0.1.0-silver.svg" class="icon-link-image" alt="mjlab"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://img.shields.io/github/stars/mujocolab/mjlab?color=fedcba" title="Stars" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://img.shields.io/github/stars/mujocolab/mjlab?color=fedcba" class="icon-link-image" alt="Stars"/></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_isaac_lab.html">Migrating from Isaac Lab</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About the Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Why mjlab?</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ &amp; Troubleshooting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="api/envs.html">mjlab.envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scene.html">mjlab.scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sim.html">mjlab.sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/entity.html">mjlab.entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/actuator.html">mjlab.actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sensor.html">mjlab.sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/managers.html">mjlab.managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/terrains.html">mjlab.terrains</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="randomization.html">Domain Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nan_guard.html">NaN Guard</a></li>
<li class="toctree-l1"><a class="reference internal" href="observation.html">Observation History and Delay</a></li>
<li class="toctree-l1"><a class="reference internal" href="actuators.html">Actuators</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="raycast_sensor.html">RayCast Sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed_training.html">Distributed Training</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/edit/main/docs/source/sensors.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/issues/new?title=Issue%20on%20page%20%2Fsource/sensors.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/source/sensors.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sensors</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-note-entity-data-vs-sensors">Quick Note: Entity Data vs Sensors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sensor-types">Sensor Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#builtinsensor">BuiltinSensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contactsensor">ContactSensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raycastsensor">RayCastSensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">BuiltinSensor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Sensor Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">ContactSensor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pattern-matching">Pattern Matching</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-contactdata">Output: ContactData</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-num-slots">Understanding num_slots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-discovery">Auto-discovery</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-patterns">Usage Patterns</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="sensors">
<span id="id1"></span><h1>Sensors<a class="headerlink" href="#sensors" title="Link to this heading">#</a></h1>
<p>Sensors provide a configurable way to measure physical quantities
in your simulation. They live at the scene level alongside entities
and terrain, can reference multiple entities (e.g., detect contact
between robot and terrain), and return structured data for use in
rewards, terminations, and observations.</p>
<section id="quick-note-entity-data-vs-sensors">
<h2>Quick Note: Entity Data vs Sensors<a class="headerlink" href="#quick-note-entity-data-vs-sensors" title="Link to this heading">#</a></h2>
<p><strong>Before diving into sensors</strong>, it’s helpful to understand that mjlab provides two complementary ways to access simulation data:</p>
<p><strong>Entity Data</strong> (<code class="docutils literal notranslate"><span class="pre">entity.data.*</span></code>)</p>
<ul class="simple">
<li><p>Common quantities are available out of the box with zero configuration</p></li>
<li><p>Provides convenient coordinate frame transformations between world and body frames, COM and link frames</p></li>
<li><p>Offers a familiar API for users coming from Isaac Lab</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">robot.data.root_link_lin_vel_b</span></code>, <code class="docutils literal notranslate"><span class="pre">robot.data.joint_pos</span></code></p></li>
</ul>
<p><strong>Sensors</strong> (this system)</p>
<ul class="simple">
<li><p>Provides reusable, configurable sensor definitions that can be shared across tasks</p></li>
<li><p>Extensible through subclassing to add custom logic like noise, filtering, or processing</p></li>
<li><p>Maps directly to real robot sensors like IMUs, force sensors, and cameras</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">env.scene[&quot;feet_contact&quot;].data</span></code>, <code class="docutils literal notranslate"><span class="pre">env.scene[&quot;robot/imu&quot;].data</span></code></p></li>
</ul>
<p><strong>Use them together:</strong></p>
<ul class="simple">
<li><p>Use entity data for quick access to state and transforms</p></li>
<li><p>Use sensors for measurements that span entities or need configuration</p></li>
<li><p>Mix both approaches freely in your rewards and observations based on your needs</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.sensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuiltinSensorCfg</span><span class="p">,</span> <span class="n">ContactSensorCfg</span><span class="p">,</span> <span class="n">ContactMatch</span><span class="p">,</span> <span class="n">ObjRef</span>

<span class="n">scene_cfg</span> <span class="o">=</span> <span class="n">SceneCfg</span><span class="p">(</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;robot&quot;</span><span class="p">:</span> <span class="n">robot_cfg</span><span class="p">},</span>
    <span class="n">sensors</span><span class="o">=</span><span class="p">(</span>
        <span class="n">BuiltinSensorCfg</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;imu_acc&quot;</span><span class="p">,</span>
            <span class="n">sensor_type</span><span class="o">=</span><span class="s2">&quot;accelerometer&quot;</span><span class="p">,</span>
            <span class="n">obj</span><span class="o">=</span><span class="n">ObjRef</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;site&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;imu_site&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">ContactSensorCfg</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;feet_contact&quot;</span><span class="p">,</span>
            <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;.*_foot$&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
            <span class="n">secondary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">),</span>
            <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="s2">&quot;force&quot;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Access at runtime.</span>
<span class="n">imu_acc_data</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot/imu_acc&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># [B, 3] acceleration</span>
<span class="n">feet_contact</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;feet_contact&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>   <span class="c1"># ContactData with .found, .force</span>
</pre></div>
</div>
</section>
<section id="sensor-types">
<h2>Sensor Types<a class="headerlink" href="#sensor-types" title="Link to this heading">#</a></h2>
<p>mjlab provides three sensor implementations:</p>
<section id="builtinsensor">
<h3>BuiltinSensor<a class="headerlink" href="#builtinsensor" title="Link to this heading">#</a></h3>
<p>Wraps MuJoCo’s native sensor types (57 total) for measuring forces, positions,
velocities, and other physical quantities. Returns raw <cite>torch.Tensor</cite> data.</p>
</section>
<section id="contactsensor">
<h3>ContactSensor<a class="headerlink" href="#contactsensor" title="Link to this heading">#</a></h3>
<p>Detects contacts between bodies, geoms, or subtrees. Returns structured
<cite>ContactData</cite> with forces, positions, air time metrics, etc.</p>
</section>
<section id="raycastsensor">
<h3>RayCastSensor<a class="headerlink" href="#raycastsensor" title="Link to this heading">#</a></h3>
<p>GPU-accelerated raycasting for terrain scanning and depth sensing. Supports
grid and pinhole camera patterns with configurable alignment modes.
See <a class="reference internal" href="raycast_sensor.html#raycast-sensor"><span class="std std-ref">RayCast Sensor</span></a> for full documentation.</p>
</section>
</section>
<section id="id2">
<h2>BuiltinSensor<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Sensor Types<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Available Sensors</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Site</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">accelerometer</span></code>, <code class="docutils literal notranslate"><span class="pre">velocimeter</span></code>, <code class="docutils literal notranslate"><span class="pre">gyro</span></code>, <code class="docutils literal notranslate"><span class="pre">force</span></code>, <code class="docutils literal notranslate"><span class="pre">torque</span></code>, <code class="docutils literal notranslate"><span class="pre">magnetometer</span></code>, <code class="docutils literal notranslate"><span class="pre">rangefinder</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Joint</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jointpos</span></code>, <code class="docutils literal notranslate"><span class="pre">jointvel</span></code>, <code class="docutils literal notranslate"><span class="pre">jointlimitpos</span></code>, <code class="docutils literal notranslate"><span class="pre">jointlimitvel</span></code>, <code class="docutils literal notranslate"><span class="pre">jointlimitfrc</span></code>, <code class="docutils literal notranslate"><span class="pre">jointactuatorfrc</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Frame</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">framepos</span></code>, <code class="docutils literal notranslate"><span class="pre">framequat</span></code>, <code class="docutils literal notranslate"><span class="pre">framexaxis</span></code>, <code class="docutils literal notranslate"><span class="pre">frameyaxis</span></code>, <code class="docutils literal notranslate"><span class="pre">framezaxis</span></code>, <code class="docutils literal notranslate"><span class="pre">framelinvel</span></code>, <code class="docutils literal notranslate"><span class="pre">frameangvel</span></code>, <code class="docutils literal notranslate"><span class="pre">framelinacc</span></code>, <code class="docutils literal notranslate"><span class="pre">frameangacc</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Other</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">actuatorpos</span></code>, <code class="docutils literal notranslate"><span class="pre">actuatorvel</span></code>, <code class="docutils literal notranslate"><span class="pre">actuatorfrc</span></code>, <code class="docutils literal notranslate"><span class="pre">subtreecom</span></code>, <code class="docutils literal notranslate"><span class="pre">subtreelinvel</span></code>, <code class="docutils literal notranslate"><span class="pre">subtreeangmom</span></code>, <code class="docutils literal notranslate"><span class="pre">clock</span></code>, <code class="docutils literal notranslate"><span class="pre">e_potential</span></code>, <code class="docutils literal notranslate"><span class="pre">e_kinetic</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h3>
<p>BuiltinSensor returns a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> with
shape <code class="docutils literal notranslate"><span class="pre">[N_envs,</span> <span class="pre">dim]</span></code> where dim depends on the
sensor type (e.g., 3 for vectors, 4 for quaternions).
Configure with <code class="docutils literal notranslate"><span class="pre">BuiltinSensorCfg</span></code>, specifying the
sensor type, attached object via <code class="docutils literal notranslate"><span class="pre">ObjRef</span></code>, and
optional parameters like <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> to limit
output magnitude or <code class="docutils literal notranslate"><span class="pre">ref</span></code> for frame sensors.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accelerometer.</span>
<span class="n">imu_acc</span> <span class="o">=</span> <span class="n">BuiltinSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;imu_acc&quot;</span><span class="p">,</span>
    <span class="n">sensor_type</span><span class="o">=</span><span class="s2">&quot;accelerometer&quot;</span><span class="p">,</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">ObjRef</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;site&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;imu_site&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Joint limits.</span>
<span class="n">joint_limit</span> <span class="o">=</span> <span class="n">BuiltinSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;knee_limit&quot;</span><span class="p">,</span>
    <span class="n">sensor_type</span><span class="o">=</span><span class="s2">&quot;jointlimitpos&quot;</span><span class="p">,</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">ObjRef</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;joint&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;knee_joint&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Frame tracking (relative position).</span>
<span class="n">ee_pos</span> <span class="o">=</span> <span class="n">BuiltinSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ee_pos&quot;</span><span class="p">,</span>
    <span class="n">sensor_type</span><span class="o">=</span><span class="s2">&quot;framepos&quot;</span><span class="p">,</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">ObjRef</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;end_effector&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">ref</span><span class="o">=</span><span class="n">ObjRef</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h2>ContactSensor<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>ContactSensor detects and reports contact between
bodies, geoms, or entire subtrees in your simulation.
It’s particularly useful for foot contact detection,
self-collision monitoring, and measuring ground reaction
forces. The sensor tracks contacts between a “primary” set
of objects (e.g., robot feet) and an optional “secondary”
set (e.g., terrain), returning structured data including
forces, positions, and timing information.</p>
<section id="pattern-matching">
<h3>Pattern Matching<a class="headerlink" href="#pattern-matching" title="Link to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">ContactMatch</span></code> to specify what to track:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ContactMatch</span><span class="p">(</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span>              <span class="c1"># &quot;geom&quot;, &quot;body&quot;, or &quot;subtree&quot;</span>
    <span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;.*_foot$&quot;</span><span class="p">,</span>      <span class="c1"># Regex or list of names</span>
    <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">,</span>           <span class="c1"># Optional entity scope</span>
    <span class="n">exclude</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*_heel$&quot;</span><span class="p">,),</span>   <span class="c1"># Optional exclusions</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Patterns can be:
- <strong>List of exact names:</strong> <code class="docutils literal notranslate"><span class="pre">[&quot;left_foot&quot;,</span> <span class="pre">&quot;right_foot&quot;]</span></code>
- <strong>Regex:</strong> <code class="docutils literal notranslate"><span class="pre">r&quot;.*_collision$&quot;</span></code> (expands to all matches)
- <strong>With exclusions:</strong> Filter out specific matches</p>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ContactSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;feet_ground&quot;</span><span class="p">,</span>
    <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>     <span class="c1"># What to track</span>
    <span class="n">secondary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>   <span class="c1"># Optional filter</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="s2">&quot;force&quot;</span><span class="p">),</span>     <span class="c1"># Data to extract</span>
    <span class="n">reduce</span><span class="o">=</span><span class="s2">&quot;maxforce&quot;</span><span class="p">,</span>              <span class="c1"># Contact selection</span>
    <span class="n">num_slots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                    <span class="c1"># Contacts per primary</span>
    <span class="n">track_air_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>           <span class="c1"># Landing/takeoff tracking</span>
    <span class="n">global_frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>             <span class="c1"># Force frame</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Fields:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;found&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;force&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;torque&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;dist&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pos&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;normal&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;tangent&quot;</span></code></p>
<p><strong>Reduction modes:</strong>
- <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> - Fast, non-deterministic
- <code class="docutils literal notranslate"><span class="pre">&quot;mindist&quot;</span></code> - Closest contacts
- <code class="docutils literal notranslate"><span class="pre">&quot;maxforce&quot;</span></code> - Strongest contacts
- <code class="docutils literal notranslate"><span class="pre">&quot;netforce&quot;</span></code> - Returns single synthetic contact at force-weighted centroid with net wrench</p>
</section>
<section id="output-contactdata">
<h3>Output: ContactData<a class="headerlink" href="#output-contactdata" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContactData</span><span class="p">:</span>
    <span class="n">found</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>        <span class="c1"># [B, N] contact count</span>
    <span class="n">force</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>        <span class="c1"># [B, N, 3]</span>
    <span class="n">torque</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>       <span class="c1"># [B, N, 3]</span>
    <span class="n">dist</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>         <span class="c1"># [B, N] penetration</span>
    <span class="n">pos</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>          <span class="c1"># [B, N, 3] position</span>
    <span class="n">normal</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>       <span class="c1"># [B, N, 3] primary→secondary</span>
    <span class="n">tangent</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>      <span class="c1"># [B, N, 3]</span>

    <span class="c1"># With track_air_time=True.</span>
    <span class="n">current_air_time</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">last_air_time</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">current_contact_time</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">last_contact_time</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Shape: <code class="docutils literal notranslate"><span class="pre">[B,</span> <span class="pre">N</span> <span class="pre">*</span> <span class="pre">num_slots]</span></code> where N = number of primary matches</p>
</section>
<section id="understanding-num-slots">
<h3>Understanding num_slots<a class="headerlink" href="#understanding-num-slots" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_slots=1</span></code> (most common): Single representative contact per match</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_slots</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>: Multiple contact points per geom/body</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce=&quot;netforce&quot;</span></code>: Always returns exactly one contact regardless of num_slots</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4 feet, 1 contact each → [B, 4].</span>
<span class="n">ContactSensorCfg</span><span class="p">(</span><span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LF&quot;</span><span class="p">,</span> <span class="s2">&quot;RF&quot;</span><span class="p">,</span> <span class="s2">&quot;LH&quot;</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">]),</span> <span class="n">num_slots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 4 feet, 3 contacts each → [B, 12].</span>
<span class="n">ContactSensorCfg</span><span class="p">(</span><span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LF&quot;</span><span class="p">,</span> <span class="s2">&quot;RF&quot;</span><span class="p">,</span> <span class="s2">&quot;LH&quot;</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">]),</span> <span class="n">num_slots</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>Examples<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Foot contacts with forces.</span>
<span class="n">feet</span> <span class="o">=</span> <span class="n">ContactSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;feet_ground&quot;</span><span class="p">,</span>
    <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;.*_foot$&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">secondary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">),</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="s2">&quot;force&quot;</span><span class="p">,</span> <span class="s2">&quot;pos&quot;</span><span class="p">),</span>
    <span class="n">reduce</span><span class="o">=</span><span class="s2">&quot;maxforce&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Self-collision detection.</span>
<span class="n">self_collision</span> <span class="o">=</span> <span class="n">ContactSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;self_collision&quot;</span><span class="p">,</span>
    <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;subtree&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;pelvis&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">secondary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;subtree&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;pelvis&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,),</span>
<span class="p">)</span>

<span class="c1"># Air time tracking for gait analysis.</span>
<span class="n">feet_air</span> <span class="o">=</span> <span class="n">ContactSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;feet_air&quot;</span><span class="p">,</span>
    <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LF&quot;</span><span class="p">,</span> <span class="s2">&quot;RF&quot;</span><span class="p">,</span> <span class="s2">&quot;LH&quot;</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">],</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">track_air_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,),</span>
<span class="p">)</span>

<span class="c1"># Net ground reaction force.</span>
<span class="n">grf</span> <span class="o">=</span> <span class="n">ContactSensorCfg</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;grf&quot;</span><span class="p">,</span>
    <span class="n">primary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;subtree&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;left_ankle&quot;</span><span class="p">,</span> <span class="s2">&quot;right_ankle&quot;</span><span class="p">],</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">),</span>
    <span class="n">secondary</span><span class="o">=</span><span class="n">ContactMatch</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">),</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;force&quot;</span><span class="p">,),</span>
    <span class="n">reduce</span><span class="o">=</span><span class="s2">&quot;netforce&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="auto-discovery">
<h2>Auto-discovery<a class="headerlink" href="#auto-discovery" title="Link to this heading">#</a></h2>
<p>Sensors defined in an entity’s XML are automatically discovered and prefixed with the entity’s name.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- In robot.xml --&gt;</span>
<span class="nt">&lt;sensor&gt;</span>
<span class="w">    </span><span class="nt">&lt;accelerometer</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;trunk_imu&quot;</span><span class="w"> </span><span class="na">site=</span><span class="s">&quot;imu_site&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;jointpos</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;hip_sensor&quot;</span><span class="w"> </span><span class="na">joint=</span><span class="s">&quot;hip_joint&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/sensor&gt;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">imu</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot/trunk_imu&quot;</span><span class="p">]</span>
<span class="n">hip</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot/hip_sensor&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="usage-patterns">
<h2>Usage Patterns<a class="headerlink" href="#usage-patterns" title="Link to this heading">#</a></h2>
<p><strong>In observations</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">imu_acc_obs</span><span class="p">(</span><span class="n">env</span><span class="p">:</span> <span class="n">ManagerBasedRlEnv</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="n">sensor</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot/imu_acc&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sensor</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># [N_envs, 3]</span>
</pre></div>
</div>
<p><strong>In rewards</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">foot_slip</span><span class="p">(</span><span class="n">env</span><span class="p">:</span> <span class="n">ManagerBasedRlEnv</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="n">sensor</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;feet_ground&quot;</span><span class="p">]</span>
    <span class="n">vel</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">force</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">in_contact</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">found</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">in_contact</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>In terminations</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">illegal_contact</span><span class="p">(</span><span class="n">env</span><span class="p">:</span> <span class="n">ManagerBasedRlEnv</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="n">sensor</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;nonfoot_contact&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sensor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">found</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># [B]</span>
</pre></div>
</div>
<p><strong>Air time helpers</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sensor</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;feet_air&quot;</span><span class="p">]</span>
<span class="n">first_contact</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">compute_first_contact</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># Just landed</span>
<span class="n">first_air</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">compute_first_air</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>          <span class="c1"># Just took off</span>
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="actuators.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Actuators</p>
      </div>
    </a>
    <a class="right-next"
       href="raycast_sensor.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">RayCast Sensor</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-note-entity-data-vs-sensors">Quick Note: Entity Data vs Sensors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sensor-types">Sensor Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#builtinsensor">BuiltinSensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contactsensor">ContactSensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raycastsensor">RayCastSensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">BuiltinSensor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Sensor Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">ContactSensor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pattern-matching">Pattern Matching</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-contactdata">Output: ContactData</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-num-slots">Understanding num_slots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-discovery">Auto-discovery</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-patterns">Usage Patterns</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The mjlab Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, The mjlab Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jan 28, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>